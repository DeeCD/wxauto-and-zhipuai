# 微信 AI 聊天机器人

这是一个基于 `wxauto` 和智谱 AI (`zhipuai`) 的微信聊天机器人项目，可以实现自动监听指定聊天窗口的消息，并根据配置进行智能回复。

## 项目结构

```
.
├── wechat_ai_glm.py   # 机器人核心逻辑
├── diagnose.py        # 环境诊断脚本
├── run.bat            #运行脚本
└── README.md          # 项目说明文档
```

## 主要功能

- **自动监听**: 实时监听微信主窗口所显示的对话
- **智能回复**: 对接收到的消息，调用智谱 AI 的大语言模型生成回复。
- **灵活配置**: 
    - 可自定义使用的 AI 模型。
- **消息去重**: 避免对重复消息进行重复处理。
- **环境诊断**: 提供独立的脚本来检测微信进程、窗口以及 API 连通性。

## 使用说明

### 1. 环境准备
确保微信客户端版本为3.9.8+，不支持3.9.40

确保你已经安装了所需的 Python 库：

```bash
pip install wxauto
pip install zhipuai
```

### 2. 配置

打开 `wechat_ai_glm.py` 文件，修改顶部的配置区域：

- `API_KEY`: 填入你的智谱 AI API Key。（已经填入，保证开箱即用）
- `TARGET_CHATS`: 设置你想要机器人监听的聊天名称列表，例如 `["文件传输助手", "某个群聊"]`。
- `REPLY_MODE`: 
    - `"全部回复"`: 机器人会回复监听对象的所有消息。
    - `"@回复"`: 机器人只会在群聊中被`@`时才回复。
- `MODEL_NAME`: 使用的 AI 模型，默认为 `glm-4-flash`。

### 3. 运行

在运行前，请**确保微信 PC 版已经登录，并且主窗口处于可见状态**。

```
点击run.bat
```

运行后，脚本会开始监听指定聊天的消息并自动回复。

### 4. 环境诊断

如果遇到问题，可以先运行诊断脚本来检查环境是否正常：

```bash
python diagnose.py
```

它会检查以下几项：
- 微信进程是否在运行。
- 微信主窗口是否能被程序识别。
- 与智谱 AI 的 API 连接是否通畅。

## 文件说明

- **`wechat_ai_glm.py`**: 核心文件。包含了 `ZhipuAIClient` 类用于与 AI 模型交互，以及 `WeChatAIBot` 类用于处理微信消息的监听、解析和发送。
- **`diagnose.py`**: 一个独立的工具，用于帮助用户快速定位环境问题，例如微信未启动或网络问题。
